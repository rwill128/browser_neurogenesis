// --- Config Object ---
const config = {
    // --- Viewport and World Dimensions ---
    WORLD_WIDTH: 20000,
    WORLD_HEIGHT: 16000,
    VIEW_PAN_SPEED: 80,
    viewOffsetX: 0,
    viewOffsetY: 0,
    viewZoom: 1.0,
    ZOOM_SENSITIVITY: 0.02,
    MIN_ZOOM: 0.1,
    isRightDragging: false,

    // Spatial Grid for optimization
    GRID_CELL_SIZE: 100,

    // Moved these critical constants higher up
    NEURON_CHANCE: 0.1,
    MAX_PIXELS_PER_FRAME_DISPLACEMENT: 300,
    MAX_SPRING_STRETCH_FACTOR: 20.0,
    MAX_SPAN_PER_POINT_FACTOR: 300, // GRID_CELL_SIZE * 3
    DYE_PULL_RATE: 0.05,

    // Rigid Spring Properties (New)
    RIGID_SPRING_STIFFNESS: 500000, 
    RIGID_SPRING_DAMPING: 150,    
    CHANCE_FOR_RIGID_SPRING: 0.5,

    // Spring Mutation Constants (New)
    SPRING_DELETION_CHANCE: 0.02,
    SPRING_ADDITION_CHANCE: 0.02,
    SPRING_PROP_MUTATION_MAGNITUDE: 0.1,
    MIN_SPRINGS_PER_NEW_NODE: 1,
    MAX_SPRINGS_PER_NEW_NODE: 3,
    NEW_SPRING_REST_LENGTH_VARIATION: 0.2,

    // Body Scale Mutation Constants (New)
    BODY_SCALE_MUTATION_CHANCE: 0.03,
    BODY_SCALE_MUTATION_MAGNITUDE: 0.1,

    // Spring Subdivision Mutation (New)
    SPRING_SUBDIVISION_MUTATION_CHANCE: 0.02,

    // Segment Duplication Mutation (New)
    SEGMENT_DUPLICATION_CHANCE: 0.01,
    MIN_SEGMENT_LENGTH_FOR_DUPLICATION: 3,
    MAX_SEGMENT_LENGTH_FOR_DUPLICATION: 7,
    SEGMENT_DUPLICATION_OFFSET_SCALE: 1.0,

    // Original Radius Multipliers (will become base values)
    EATING_RADIUS_MULTIPLIER_BASE: 0.1,
    PREDATION_RADIUS_MULTIPLIER_BASE: 0.1,

    // Exertion Bonuses for Radius Multipliers
    EATING_RADIUS_MULTIPLIER_MAX_BONUS: 15.0,
    PREDATION_RADIUS_MULTIPLIER_MAX_BONUS: 12.5,
    ATTRACTION_RADIUS_MULTIPLIER_BASE: 0.1,
    ATTRACTION_RADIUS_MULTIPLIER_MAX_BONUS: 20.0,
    REPULSION_RADIUS_MULTIPLIER_BASE: 0.1,
    REPULSION_RADIUS_MULTIPLIER_MAX_BONUS: 20.0,

    ENERGY_PER_PARTICLE: 25,
    ENERGY_SAPPED_PER_PREDATION_BASE: 3,
    ENERGY_SAPPED_PER_PREDATION_MAX_BONUS: 7,

    // Dynamic Max Energy per Creature (New)
    BASE_MAX_CREATURE_ENERGY: 100,
    ENERGY_PER_MASS_POINT_BONUS: 25,
    OFFSPRING_INITIAL_ENERGY_SHARE: 0.25,
    REPRODUCTION_ADDITIONAL_COST_FACTOR: 0.1,
    OFFSPRING_PLACEMENT_ATTEMPTS: 10,
    OFFSPRING_PLACEMENT_CLEARANCE_RADIUS: 50,
    MUTATION_RATE_PERCENT: 0.1,
    MUTATION_CHANCE_BOOL: 0.05,
    MUTATION_CHANCE_NODE_TYPE: 0.1,
    MUTATION_CHANCE_REASSIGN_NEURON_LINK: 0.02,
    ADD_POINT_MUTATION_CHANCE: 0.03,
    NEW_POINT_OFFSET_RADIUS: 15,
    isAnySoftBodyUnstable: false,
    RED_DYE_POISON_STRENGTH: 0.5,
    JET_MAX_VELOCITY_GENE_DEFAULT: 2.0,

    // Cooldown for failed reproduction attempts
    FAILED_REPRODUCTION_COOLDOWN_TICKS: 100,

    MAX_CREATURE_AGE_TICKS: 10000,

    // --- Global Variables & Constants (with initial hardcoded defaults) ---
    CREATURE_POPULATION_FLOOR: 100,
    CREATURE_POPULATION_CEILING: 10000,
    PARTICLE_POPULATION_FLOOR: 0,
    PARTICLE_POPULATION_CEILING: 60000,
    canCreaturesReproduceGlobally: true,

    BODY_FLUID_ENTRAINMENT_FACTOR: 0.485,
    FLUID_CURRENT_STRENGTH_ON_BODY: 19.7,
    SOFT_BODY_PUSH_STRENGTH: 0.10,
    BODY_REPULSION_STRENGTH: 100.0,
    BODY_REPULSION_RADIUS_FACTOR: 5.0,
    GLOBAL_MUTATION_RATE_MODIFIER: 0.25,
    MAX_DELTA_TIME_MS: 10,
    IS_SIMULATION_PAUSED: false,
    IS_EMITTER_EDIT_MODE: false,
    EMITTER_STRENGTH: 3.0,
    EMITTER_MOUSE_DRAG_SCALE: 0.1,
    FLUID_MOUSE_DRAG_VELOCITY_SCALE: 0.1,

    BASE_NODE_EXISTENCE_COST: 0.0,
    EMITTER_NODE_ENERGY_COST: 0.1,
    EATER_NODE_ENERGY_COST: 10.0,
    PREDATOR_NODE_ENERGY_COST: 10.0,
    NEURON_NODE_ENERGY_COST: 0.001,
    SWIMMER_NODE_ENERGY_COST: 0.1,
    PHOTOSYNTHETIC_NODE_ENERGY_COST: 0.1,
    GRABBING_NODE_ENERGY_COST: 0.25,
    EYE_NODE_ENERGY_COST: 0.05,
    JET_NODE_ENERGY_COST: 0.5,
    ATTRACTOR_NODE_ENERGY_COST: 1.0,
    REPULSOR_NODE_ENERGY_COST: 1.0,
    PHOTOSYNTHESIS_EFFICIENCY: 100.0,

    // Eye Detection Radius (New)
    EYE_DETECTION_RADIUS: 300,

    FLUID_GRID_SIZE_CONTROL: 128,
    FLUID_DIFFUSION: 0.00047,
    FLUID_VISCOSITY: 0.0005,
    FLUID_FADE_RATE: 0.01,
    MAX_FLUID_VELOCITY_COMPONENT: 10.0,
    IS_WORLD_WRAPPING: false,
    PARTICLES_PER_SECOND: 100,
    PARTICLE_FLUID_INFLUENCE: 0.9,
    PARTICLE_BASE_LIFE_DECAY: 0.001,
    IS_PARTICLE_LIFE_INFINITE: true,
    PARTICLE_LIFE_DECAY_RANDOM_FACTOR: 0.002,
    particleEmissionDebt: 0,
    SHOW_FLUID_VELOCITY: false,

    IS_NUTRIENT_EDIT_MODE: false,
    SHOW_NUTRIENT_MAP: false,

    NUTRIENT_BRUSH_VALUE: 1.0,
    NUTRIENT_BRUSH_SIZE: 5,
    NUTRIENT_BRUSH_STRENGTH: 0.1,
    MIN_NUTRIENT_VALUE: 0.1,
    MAX_NUTRIENT_VALUE: 2.0,
    isPaintingNutrients: false,

    IS_LIGHT_EDIT_MODE: false,
    SHOW_LIGHT_MAP: false,
    LIGHT_BRUSH_VALUE: 0.5,
    LIGHT_BRUSH_SIZE: 5,
    LIGHT_BRUSH_STRENGTH: 0.1,
    MIN_LIGHT_VALUE: 0.0,
    MAX_LIGHT_VALUE: 1.0,
    isPaintingLight: false,

    IS_VISCOSITY_EDIT_MODE: false,
    SHOW_VISCOSITY_MAP: false,
    VISCOSITY_BRUSH_VALUE: 1.0,
    VISCOSITY_BRUSH_SIZE: 5,
    VISCOSITY_BRUSH_STRENGTH: 0.1,
    MIN_VISCOSITY_MULTIPLIER: 0.2,
    MAX_VISCOSITY_MULTIPLIER: 10.0,
    isPaintingViscosity: false,

    totalSimulationTime: 0.0,
    nutrientCyclePeriodSeconds: 300,
    nutrientCycleBaseAmplitude: 0.65,
    nutrientCycleWaveAmplitude: 0.35,
    lightCyclePeriodSeconds: 480,
    globalNutrientMultiplier: 1.0,
    globalLightMultiplier: 1.0,

    INITIAL_POPULATION_SIZE: 0, // Set in main.js based on floor

    velocityEmitters: [],
    currentEmitterPreview: null,
    emitterDragStartCell: null,
    selectedInspectBody: null,
    selectedInspectPoint: null,
    selectedInspectPointIndex: -1,
    isRightDragging: false,
    lastPanMouseX: 0,
    lastPanMouseY: 0,

    // --- Neural Network Constants ---
    NEURAL_INPUT_SIZE_BASE: 10,
    NEURAL_INPUTS_PER_SPRING_SENSOR: 1,
    NEURAL_OUTPUTS_PER_PREDATOR: 2,
    NEURAL_OUTPUTS_PER_EATER: 2,
    NEURAL_OUTPUTS_PER_ATTRACTOR: 2,
    NEURAL_OUTPUTS_PER_REPULSOR: 2,
    NEURAL_OUTPUTS_PER_EMITTER: 8,
    NEURAL_OUTPUTS_PER_SWIMMER: 4,
    NEURAL_OUTPUTS_PER_JET: 4,
    NEURAL_OUTPUTS_PER_GRABBER_TOGGLE: 2,
    NEURAL_INPUTS_PER_FLUID_SENSOR: 2,
    NEURAL_INPUTS_PER_EYE: 3,

    DEFAULT_HIDDEN_LAYER_SIZE_MIN: 5,
    DEFAULT_HIDDEN_LAYER_SIZE_MAX: 30,
    MAX_SWIMMER_OUTPUT_MAGNITUDE: 1.0,
    MAX_JET_OUTPUT_MAGNITUDE: 2.0,
    ATTRACTOR_MAX_FORCE: 5.0,
    REPULSOR_MAX_FORCE: 5.0,
    MAX_NEURAL_EMISSION_PULL_STRENGTH: 1.0,

    // --- RL Training Constants ---
    LEARNING_RATE: 0.001,
    DISCOUNT_FACTOR_GAMMA: 0.99,
    TRAINING_INTERVAL_FRAMES: 10,

    DyeChannel: {
        RED: 0,
        GREEN: 1,
        BLUE: 2,
        AVERAGE: 3
    },
    DYE_COLORS: {
        RED: [200, 50, 50],
        GREEN: [50, 200, 50],
        BLUE: [50, 50, 200]
    },

    // Subgraph Translocation Mutation (New - Complex)
    SUBGRAPH_TRANSLOCATION_CHANCE: 0.15,
    MIN_SUBGRAPH_SIZE_FOR_TRANSLOCATION: 3,
    MAX_SUBGRAPH_SIZE_FOR_TRANSLOCATION: 8,

    // Symmetrical Subgraph Duplication along an Edge (New - Complex)
    SYMMETRIC_SUBGRAPH_DUPLICATION_CHANCE: 0.2,
    MIN_SUBGRAPH_SIZE_FOR_SYMMETRIC_DUP: 3,
    MAX_SUBGRAPH_SIZE_FOR_SYMMETRIC_DUP: 7,

    // Whole-Body Symmetrical Duplication along an Edge (New - Very Complex)
    SYMMETRICAL_BODY_DUPLICATION_CHANCE: 0.25,

    // Heritable Reward Weights & Related (New)
    REWARD_WEIGHT_MUTATION_CHANCE: 0.1,
    REWARD_WEIGHT_MUTATION_MAGNITUDE: 0.2,
    REWARD_WEIGHT_MIN: 0.0,
    REWARD_WEIGHT_MAX: 2.0,
    REPRODUCTION_REWARD_VALUE: 50.0,
    DEFAULT_SURVIVAL_REWARD_WEIGHT: 0.01,

    RLRewardStrategy_MUTATION_CHANCE: 0.05,
    PARTICLE_PROXIMITY_REWARD_SCALE: 10.0,
    ENERGY_SECOND_DERIVATIVE_REWARD_SCALE: 5.0,
    CREATURE_PROXIMITY_REWARD_SCALE: 5.0,
    CREATURE_DISTANCE_REWARD_SCALE: 5.0,

    // New constant for Grabber Gene Mutation
    GRABBER_GENE_MUTATION_CHANCE: 0.03,

    // New: Chance for an Eye node to change its target type (particle vs. foreign body point)
    EYE_TARGET_TYPE_MUTATION_CHANCE: 0.05,

    // Default Activation Pattern for Brainless/Non-NN Controlled Nodes (New)
    ActivationPatternType: {
        FLAT: 0,
        SINE: 1,
        PULSE: 2
    },
    ACTIVATION_PATTERN_MUTATION_CHANCE: 0.05,
    ACTIVATION_PARAM_MUTATION_MAGNITUDE: 0.2,
    DEFAULT_ACTIVATION_LEVEL_MIN: 0.1,
    DEFAULT_ACTIVATION_LEVEL_MAX: 0.7,
    DEFAULT_ACTIVATION_PERIOD_MIN_TICKS: 50,
    DEFAULT_ACTIVATION_PERIOD_MAX_TICKS: 300,

    IS_HEADLESS_MODE: false,
    USE_GPU_FLUID_SIMULATION: false,
    IS_CREATURE_IMPORT_MODE: false,
    IMPORTED_CREATURE_DATA: null,
};

export default config;